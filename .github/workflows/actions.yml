name: InvestorSanity

on:
  workflow_dispatch:
    inputs:
      runnerType1:
        description: 'Select the Environement'
        required: true
        default: 'Investor_Prod'
        type: choice
        options:
        - UAT
        - QA
        - Prod

      runnerType2:
        description: 'Select Module or Execution Type'
        required: true
        default: '@IPRUSanity'
        type: choice
        options:
        - "@IPRUSanity"
        - "@regression"

      textInput:
        description: 'Enter Tags'
        required: false
        default: ''
        type: string

  repository_dispatch:
    types: [trigger-qa-sanity]

jobs:
  build:
    runs-on: ubuntu-latest
    timeout-minutes: 4320
    permissions:
      contents: read
      packages: write

    # env:
    #   RUNNER_TYPE: ${{ github.event.inputs.runnerType1 || github.event.client_payload.runnerType1 || 'Prod' }}
    #   EXECUTION_TYPE: ${{ github.event.inputs.textInput || github.event.client_payload.textInput || github.event.inputs.runnerType2 || github.event.client_payload.runnerType2 || '@IPRUSanity' }}
    #   TAGS: ${{ github.event.inputs.textInput || github.event.client_payload.textInput || '' }}

    env:
      RUNNER_TYPE: ${{ github.event.inputs.runnerType1 || 'Prod' }}
      EXECUTION_TYPE: ${{ github.event.inputs.textInput || github.event.inputs.runnerType2 || '@IPRUSanity' }}
      TAGS: ${{ github.event.inputs.textInput || '' }}

    steps:
      - name: Display Command
        run: |
          echo "Runner Type: $RUNNER_TYPE"
          echo "Execution Type: $EXECUTION_TYPE"
          echo "Tags: $TAGS"

      - uses: actions/checkout@v2

      - name: Build with Maven (Dummy)
        run: |
          echo "Running: mvn clean test -Denv=$RUNNER_TYPE -Dcucumber.filter.tags=$EXECUTION_TYPE"
          sleep 3
          echo "âœ… Dummy Sanity Execution Completed Successfully"
